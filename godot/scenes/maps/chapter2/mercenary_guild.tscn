[gd_scene load_steps=4 format=3 uid="uid://mercenary_guild_map"]

[ext_resource type="Script" path="res://scripts/map/map_data.gd" id="1_mapdata"]
[ext_resource type="Script" path="res://scripts/events/event_trigger.gd" id="2_trigger"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_door"]
size = Vector2(80, 80)

[node name="MercenaryGuild" type="Node2D"]

[node name="MapData" type="Node" parent="."]
script = ExtResource("1_mapdata")
map_id = "mercenary_guild"
map_name = "용병 길드"
chapter = 2
map_width = 1200
map_height = 800
map_type = "Indoor"
connections = {"exit_west": {"map": "res://scenes/maps/chapter2/village_square.tscn", "spawn": "from_guild"}}
entry_events = []

[node name="Floor" type="ColorRect" parent="."]
offset_right = 1200.0
offset_bottom = 800.0
color = Color(0.35, 0.3, 0.25, 1)

[node name="Counter" type="ColorRect" parent="."]
offset_left = 800.0
offset_top = 200.0
offset_right = 1100.0
offset_bottom = 300.0
color = Color(0.5, 0.35, 0.25, 1)

[node name="Tables" type="Node2D" parent="."]

[node name="Table1" type="ColorRect" parent="Tables"]
offset_left = 200.0
offset_top = 300.0
offset_right = 350.0
offset_bottom = 400.0
color = Color(0.45, 0.35, 0.2, 1)

[node name="Table2" type="ColorRect" parent="Tables"]
offset_left = 200.0
offset_top = 500.0
offset_right = 350.0
offset_bottom = 600.0
color = Color(0.45, 0.35, 0.2, 1)

[node name="Table3" type="ColorRect" parent="Tables"]
offset_left = 500.0
offset_top = 400.0
offset_right = 650.0
offset_bottom = 500.0
color = Color(0.45, 0.35, 0.2, 1)

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(100, 400)

[node name="from_village" type="Marker2D" parent="SpawnPoints"]
position = Vector2(100, 400)

[node name="NPCs" type="Node2D" parent="."]

[node name="GuildMaster" type="Marker2D" parent="NPCs"]
position = Vector2(950, 350)
metadata/npc_id = "guild_master"
metadata/dialogue = "res://resources/dialogues/chapter2/guild_master.tres"

[node name="Mercenary1" type="Marker2D" parent="NPCs"]
position = Vector2(275, 350)
metadata/npc_id = "mercenary_warrior"
metadata/can_recruit = true

[node name="Mercenary2" type="Marker2D" parent="NPCs"]
position = Vector2(575, 450)
metadata/npc_id = "mercenary_archer"
metadata/can_recruit = true

[node name="Triggers" type="Node2D" parent="."]

[node name="ExitToVillage" type="Area2D" parent="Triggers"]
position = Vector2(50, 400)
script = ExtResource("2_trigger")
trigger_id = "exit_to_village_from_guild"
one_shot = false
event_type = "MapTransition"
target_map = "res://scenes/maps/chapter2/village_square.tscn"
spawn_point = "from_guild"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Triggers/ExitToVillage"]
shape = SubResource("RectangleShape2D_door")

[node name="RecruitMercenary" type="Area2D" parent="Triggers"]
position = Vector2(275, 350)
script = ExtResource("2_trigger")
trigger_id = "recruit_mercenary"
one_shot = true
event_type = "SetFlag"
flag_name = "ally_recruited"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Triggers/RecruitMercenary"]
shape = SubResource("RectangleShape2D_door")

[node name="UI" type="CanvasLayer" parent="."]
layer = 10

[node name="MapNameLabel" type="Label" parent="UI"]
offset_left = 20.0
offset_top = 20.0
offset_right = 300.0
offset_bottom = 50.0
text = "용병 길드"
