[gd_scene load_steps=4 format=3 uid="uid://dark_forest_entrance_map"]

[ext_resource type="Script" path="res://scripts/map/map_data.gd" id="1_mapdata"]
[ext_resource type="Script" path="res://scripts/events/event_trigger.gd" id="2_trigger"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_area"]
size = Vector2(100, 100)

[node name="DarkForestEntrance" type="Node2D"]

[node name="MapData" type="Node" parent="."]
script = ExtResource("1_mapdata")
map_id = "dark_forest_entrance"
map_name = "어둠의 숲 입구"
chapter = 3
map_width = 1600
map_height = 1000
map_type = "Field"
connections = {"exit_north": {"map": "res://scenes/maps/chapter3/corrupted_shrine.tscn", "spawn": "from_forest"}}
entry_events = ["chapter3_start"]

[node name="Background" type="ColorRect" parent="."]
offset_right = 1600.0
offset_bottom = 1000.0
color = Color(0.15, 0.18, 0.12, 1)

[node name="Trees" type="Node2D" parent="."]

[node name="Tree1" type="ColorRect" parent="Trees"]
offset_left = 100.0
offset_top = 100.0
offset_right = 180.0
offset_bottom = 300.0
color = Color(0.1, 0.12, 0.08, 1)

[node name="Tree2" type="ColorRect" parent="Trees"]
offset_left = 300.0
offset_top = 50.0
offset_right = 380.0
offset_bottom = 250.0
color = Color(0.1, 0.12, 0.08, 1)

[node name="Tree3" type="ColorRect" parent="Trees"]
offset_left = 1400.0
offset_top = 150.0
offset_right = 1500.0
offset_bottom = 350.0
color = Color(0.1, 0.12, 0.08, 1)

[node name="Tree4" type="ColorRect" parent="Trees"]
offset_left = 200.0
offset_top = 700.0
offset_right = 280.0
offset_bottom = 900.0
color = Color(0.1, 0.12, 0.08, 1)

[node name="Tree5" type="ColorRect" parent="Trees"]
offset_left = 1300.0
offset_top = 650.0
offset_right = 1400.0
offset_bottom = 850.0
color = Color(0.1, 0.12, 0.08, 1)

[node name="Path" type="ColorRect" parent="."]
offset_left = 600.0
offset_top = 400.0
offset_right = 1000.0
offset_bottom = 600.0
color = Color(0.2, 0.18, 0.15, 1)

[node name="Fog" type="ColorRect" parent="."]
offset_right = 1600.0
offset_bottom = 1000.0
color = Color(0.3, 0.3, 0.35, 0.3)

[node name="SpawnPoints" type="Node2D" parent="."]

[node name="default" type="Marker2D" parent="SpawnPoints"]
position = Vector2(800, 800)

[node name="from_chapter2" type="Marker2D" parent="SpawnPoints"]
position = Vector2(800, 900)

[node name="from_shrine" type="Marker2D" parent="SpawnPoints"]
position = Vector2(800, 200)

[node name="EnemySpawns" type="Node2D" parent="."]

[node name="Skeleton1" type="Marker2D" parent="EnemySpawns"]
position = Vector2(400, 450)
metadata/enemy_id = "skeleton"

[node name="Skeleton2" type="Marker2D" parent="EnemySpawns"]
position = Vector2(600, 500)
metadata/enemy_id = "skeleton"

[node name="Skeleton3" type="Marker2D" parent="EnemySpawns"]
position = Vector2(1000, 450)
metadata/enemy_id = "skeleton"

[node name="Wolf1" type="Marker2D" parent="EnemySpawns"]
position = Vector2(500, 350)
metadata/enemy_id = "wolf"

[node name="Wolf2" type="Marker2D" parent="EnemySpawns"]
position = Vector2(900, 380)
metadata/enemy_id = "wolf"

[node name="Triggers" type="Node2D" parent="."]

[node name="ChapterStartTrigger" type="Area2D" parent="Triggers"]
position = Vector2(800, 700)
script = ExtResource("2_trigger")
trigger_id = "chapter3_intro"
one_shot = true
event_type = "Dialogue"
dialogue_path = "res://resources/dialogues/chapter3/intro.tres"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Triggers/ChapterStartTrigger"]
shape = SubResource("RectangleShape2D_area")

[node name="ExitToShrine" type="Area2D" parent="Triggers"]
position = Vector2(800, 50)
script = ExtResource("2_trigger")
trigger_id = "exit_to_shrine"
one_shot = false
required_flags = ["forest_enemies_cleared"]
event_type = "MapTransition"
target_map = "res://scenes/maps/chapter3/corrupted_shrine.tscn"
spawn_point = "from_forest"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Triggers/ExitToShrine"]
shape = SubResource("RectangleShape2D_area")

[node name="UI" type="CanvasLayer" parent="."]
layer = 10

[node name="MapNameLabel" type="Label" parent="UI"]
offset_left = 20.0
offset_top = 20.0
offset_right = 300.0
offset_bottom = 50.0
text = "어둠의 숲 입구"

[node name="WarningLabel" type="Label" parent="UI"]
offset_left = 20.0
offset_top = 60.0
offset_right = 400.0
offset_bottom = 90.0
text = "강력한 적의 기운이 느껴진다..."
modulate = Color(1, 0.5, 0.5, 1)
